<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub Organization Repositories</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.datatables.net/2.1.8/css/dataTables.bootstrap5.min.css" rel="stylesheet">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.datatables.net/2.1.8/js/dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/2.1.8/js/dataTables.bootstrap5.min.js"></script>
    <style>
        body {
            padding-left: 2rem;
            padding-right: 2rem;
        }

        .dt-container .row:first-child {
            display: none;
        }

        table td:nth-child(3) {
            max-width: 200px;         
            white-space: normal;     
            overflow-wrap: break-word; 
        }

        h2 {
            margin-top: 2rem;
        }

        i {
            vertical-align: text-bottom;
        }
    </style>
</head>
<body>
    <div class="container-fluid mt-5" style="margin-bottom:2rem">
        <h1 class="text-center" style="margin-bottom: 2rem;">
            <img style="height:3rem" src="https://avatars.githubusercontent.com/u/143365389?v=4" /> 
            nopcorn/githubaudit-vulnerablerepo <br/>Github Repository Audit Results
        </h1>

        <div class="mb-4">
            <input type="text" id="globalSearch" class="form-control" placeholder="Search all results...">
        </div>

        <h3>Metrics</h3>
        <hr />
        <ul>
            <li>Total repositories: 1</li>
            <li>Total High Severity Issues: 2</li>
            <li>Total Medium Severity Issues: 1</li>
            <li>Total Low Severity Issues: 1</li>

        </ul>
        
        <h2>All Repositories</h2>
        <hr />
        <div class="table-responsive">
    <table id="results" class="table table-striped table-bordered table-hover table-sm">
        <thead>
            <tr>
                <th>Repository</th>
                <th>Tag</th>
                <th>Branch Protection</th>
                <th>Environments</th>
                <th>CODEOWNERS</th>
                <th>Secrets</th>
                <th>Rulesets</th>
                <th>Issues</th>
            </tr>
        </thead>
        <tbody>
            
                <tr>
                    <td>
                        <a href="https://github.com/nopcorn/githubaudit-vulnerablerepo" target="_blank">githubaudit-vulnerablerepo</a> 
                        <i class='bx bxs-show' alt=""></i>
                    </td>
                    <td>
                        
                    </td>
                    <td>
                        
                            <span class="badge text-bg-success">main</span>
                        
                    </td>
                    <td>
                        
                            <span class="badge bg-success">
                                production
                            </span><br />
                        
                            <span class="badge bg-danger">
                                staging
                            </span><br />
                        
                    </td>
                    <td>
                        
                            <span class="badge bg-danger">No</span>
                        
                    </td>
                    <td>
                        
                            <div class="container">
                                <pre class="bg-light p-3 border rounded">{
  &#34;_repo&#34;: [
    &#34;ETH_WALLET_PRIVATE_KEY&#34;
  ],
  &#34;production&#34;: [
    &#34;PROD_DEPLOY_KEYS&#34;
  ],
  &#34;staging&#34;: [
    &#34;STAGING_DEPLOY_KEYS&#34;
  ]
}</pre>
                            </div>
                        
                    </td>
                    <td>
                        
                            <span class="badge bg-success">Yes</span>
                        
                    </td>
                    <td>
                        
                            
                                
                                    <i class='bx bxs-error text-danger'></i>&nbsp;Branch protection is enabled but no CODEOWNERS files present<br>
                                
                            
                                
                                    <i class='bx bxs-error text-danger'></i>&nbsp;Secret present in &#34;staging&#34; environment without any environment protection<br>
                                
                            
                                
                                    <i class='bx bxs-error text-warning'></i>&nbsp;Repository-wide secrets can be accessed by anyone with &#34;write&#34; permissions on repo<br>
                                
                            
                                
                                    <i class='bx bxs-error text-secondary'></i>&nbsp;Unprotected &#34;staging&#34; environment could lead to further privilege escalation (OIDC login, etc)<br>
                                
                            
                        
                    </td>
                </tr>
            
        </tbody>
    </table>
    </div>

    </div>
    <script type="text/javascript">
        
        document.addEventListener('DOMContentLoaded', function() {
            var tables = {};
            ['results'].forEach(function(tableId) {
                tables[tableId] = new DataTable('#' + tableId, {
                    paging: false,
                    info: false,
                    searching: true
                });
            });
            document.getElementById('globalSearch').addEventListener('keyup', function() {
                var searchTerm = this.value;
                Object.values(tables).forEach(function(table) {
                    table.search(searchTerm).draw();
                });
            });
        });
    </script>
</body>
</html>